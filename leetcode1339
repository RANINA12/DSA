
class Solution {
    long max  ; 
    int total ;
    int mod = 1_000_000_007;

    public int maxProduct(TreeNode root) {
        total = getSum(root);
        helper(root);
        return (int) (max % mod);
    }

    int getSum(TreeNode root){
        if(root==null) return 0;
        return root.val + getSum(root.left)+getSum(root.right);
    }

    int helper(TreeNode root){
        if(root==null) return 0;
        int leftsum = helper(root.left);
        int rightsum = helper(root.right);
        max = Math.max(max, (long) leftsum * (total - leftsum));
        max = Math.max(max, (long) rightsum * (total - rightsum));

        return root.val + leftsum + rightsum;
    }
}
